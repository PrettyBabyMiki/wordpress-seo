var bulk_editor=function(a){var b=null,c=a.find("[class^=wpseo-new]").first().attr("class"),d="#"+c+"-",e=d.replace("new","existing"),f=a.find("th[id^=col_existing_yoast]").first().text().replace("Existing ",""),g=c.replace("-new-","_save_"),h="wpseo_save_all_"+a.attr("class").split("wpseo_bulk_")[1],i=g.replace("wpseo_save_",""),j={new_class:"."+c,new_id:d,existing_id:e},k={submit_new:function(a,c){b=c;var d=this,e=j.new_id+a,h=j.existing_id+a;if("select-one"==jQuery(j.new_id+a).prop("type"))var i=jQuery(e).find(":selected").text();else var i=jQuery(e).val();var k=jQuery(h).html();if(i==k)jQuery(e).val("").focus();else{if(""==i&&!confirm("Are you sure you want to remove the existing "+f+"?"))return jQuery(e).focus(),void jQuery(e).val("").focus();var l={action:g,_ajax_nonce:wpseo_bulk_editor_nonce,wpseo_post_id:a,new_value:i,existing_value:k};jQuery.post(ajaxurl,l,d.handle_response)}},test:function(){return j.new_id},submit_all:function(a){a.preventDefault(),b=this;var c={action:h,_ajax_nonce:wpseo_bulk_editor_nonce};c.send=!1,c.items={},c.existing_items={},jQuery(j.new_class).each(function(){var a=jQuery(this).data("id"),b=jQuery(this).val(),d=jQuery(j.existing_id+a).html();""!=b&&(b==d?jQuery(j.new_id+a).val("").focus():(c.send=!0,c.items[a]=b,c.existing_items[a]=d))}),c.send&&jQuery.post(ajaxurl,c,k.handle_responses)},handle_response:function(a,b){if("success"==b){var c=a;if("string"==typeof c&&(c=JSON.parse(c)),c instanceof Array)jQuery.each(c,function(){k.handle_response(this,b)});else if("success"==c.status){var d=c["new_"+i];jQuery(j.existing_id+c.post_id).html(d.replace(/\\(?!\\)/g,"")),jQuery(j.new_id+c.post_id).val("").focus()}else alert("Failure")}},handle_responses:function(a,b){var c=jQuery.parseJSON(a);jQuery.each(c,function(){k.handle_response(this,b)})},set_events:function(){a.find(".wpseo-save").click(function(){var a=jQuery(this).data("id");k.submit_new(a,this)}),a.find(".wpseo-save-all").click(k.submit_all),a.find(j.new_class).keypress(function(a){if(13==a.which){a.preventDefault();var b=jQuery(this).data("id");k.submit_new(b,this)}})}};return k};jQuery(document).ready(function(){var a=jQuery('table[class*="wpseo_bulk"]');a.each(function(a,b){var c=jQuery(b),d=bulk_editor(c);d.set_events()})});