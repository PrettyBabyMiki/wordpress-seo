Analyzer=function(a){this.config=a,this.init()},Analyzer.prototype.init=function(){this.initRequiredObjects(),this.initQueue(),this.loadWordlists(),this.setDefaults(),this.__output=[]},Analyzer.prototype.initRequiredObjects=function(){("object"!=typeof yst_preProcessor||yst_preProcessor.inputText!==this.config.textString)&&(yst_preProcessor=new PreProcessor(this.config.textString)),"object"!=typeof yst_stringHelper&&(yst_stringHelper=new StringHelper)},Analyzer.prototype.initQueue=function(){"object"!=typeof this.queue&&(this.queue=[]),"undefined"!=typeof this.config.queue&&0!==this.config.queue.length?this.queue=this.config.queue:this.queue=["keywordDensity","subHeadings","stopwords","fleschReading","linkCount","imageCount","urlKeyword","metaDescription","pageTitleKeyword","pageTitleCount","firstParagraph"]},Analyzer.prototype.loadWordlists=function(){"undefined"==typeof this.config.wordsToRemove&&(this.config.wordsToRemove=analyzerConfig.wordsToRemove),"undefined"==typeof this.config.stopWords&&(this.config.stopWords=analyzerConfig.stopWords)},Analyzer.prototype.setDefaults=function(){this.keywordRegex=new RegExp(this.config.keyword)},Analyzer.prototype.runQueue=function(){this.queue.length>0&&(this.__output.push(this[this.queue.shift()]()),this.runQueue())},Analyzer.prototype.abortQueue=function(){this.queue=[]},Analyzer.prototype.keywordDensity=function(){var a={name:"keywordDensity",result:{keywordDensity:0}};if(yst_preProcessor.__store.wordcount>100){var b=this.keywordDensityCheck();a.result.keywordDensity=b.toFixed(1)}return a},Analyzer.prototype.keywordDensityCheck=function(){var a=yst_stringHelper.matchString(yst_preProcessor.__store.cleanText,[this.config.keyword]),b=0;if(null!==a){var c=a.length;b=100*(c/yst_preProcessor.__store.wordcount-(c-1*c))}return b},Analyzer.prototype.subHeadings=function(){var a={name:"subHeadings",subHeadingCount:0,keywordCount:0},b=yst_preProcessor.__store.cleanTextSomeTags.match(/<h([1-6])(?:[^>]+)?>(.*?)<\/h\1>/g);return null!==b&&(a.subHeadingCount=b.length,a.keywordCount=this.subHeadingsCheck(b)),a},Analyzer.prototype.subHeadingsCheck=function(a){var b;if(null===a)b=-1;else{b=0;for(var c=0;c<a.length;c++){var d=yst_stringHelper.replaceString(a[c],this.config.wordsToRemove);(d.match(new RegExp(this.config.keyword,"g"))||a[c].match(new RegExp(this.config.keyword,"g")))&&b++}}return b},Analyzer.prototype.stopwords=function(){var a=yst_stringHelper.matchString(this.config.keyword,this.config.stopWords),b=null!==a?a.length:0;return{name:"stopWords",result:{count:b,matches:a}}},Analyzer.prototype.fleschReading=function(){var a=(206.835-1.015*(yst_preProcessor.__store.wordcount/yst_preProcessor.__store.sentencecount)-84.6*(yst_preProcessor.__store.syllablecount/yst_preProcessor.__store.wordcount)).toFixed(1);return 0>a?a=0:a>100&&(a=100),{name:"fleschReading",result:{score:a}}},Analyzer.prototype.linkCount=function(){var a=yst_preProcessor.__store.originalText.match(/<a(?:[^>]+)?>(.*?)<\/a>/g),b={total:0,internal:{total:0,dofollow:0,nofollow:0},external:{total:0,dofollow:0,nofollow:0},other:{total:0,dofollow:0,nofollow:0}};if(null!==a){b.total=a.length;for(var c=0;c<a.length;c++){var d=this.linkType(a[c]);b[d].total++;var e=this.linkFollow(a[c]);b[d][e]++}}return{name:"linkCount",result:{linkCount:b}}},Analyzer.prototype.linkType=function(a){var b="other";if(null!==a.match(/https?:\/\//g)){b="external";var c=a.match(this.config.url);null!==c&&0!==c[0].length&&(b="internal")}return b},Analyzer.prototype.linkFollow=function(a){var b="dofollow";return null!==a.match(/rel=['"]nofollow['"]/g)&&(b="nofollow"),b},Analyzer.prototype.imageCount=function(){var a={total:0,alt:0,noalt:0},b=yst_preProcessor.__store.originalText.match(/<img(?:[^>]+)?>/g);if(null!==b){a.total=b.length;for(var c=0;c<b.length;c++)this.imageAlttag(b[c])?a.alt++:a.noalt++}return{name:"imageCount",result:{imageCount:a}}},Analyzer.prototype.imageAlttag=function(a){var b=!1,c=a.match(/alt=['"](.*?)['"]/g);return null!==c&&null!==c[0].split("=")[1].match(/[a-z0-9](.*?)[a-z0-9]/g)&&(b=!0),b},Analyzer.prototype.pageTitleCount=function(){var a=0;return"undefined"!=typeof this.config.pageTitle&&(a=this.config.pageTitle.length),{name:"pageTitleCount",result:{count:a}}},Analyzer.prototype.pageTitleKeyword=function(){var a={name:"pageTitleKeyword",result:{count:0}};return"undefined"!=typeof this.config.pageTitle&&(a.result.count=yst_stringHelper.countMatches(this.config.pageTitle,this.keywordRegex)),a},Analyzer.prototype.firstParagraph=function(){var a=yst_preProcessor.__store.cleanTextSomeTags.match(/<p(?:[^>]+)?>(.*?)<\/p>/g),b={name:"firstParagraph",result:{count:0}};return null!==a&&(b.result.count=yst_stringHelper.countMatches(a[0],this.keywordRegex)),b},Analyzer.prototype.metaDescription=function(){var a={name:"metaDescription",result:{count:0,length:0}};return"undefined"!=typeof this.config.meta&&(a.result.count=yst_stringHelper.countMatches(this.config.meta,this.keywordRegex),a.result.length=this.config.meta.length),a},Analyzer.prototype.urlKeyword=function(){var a={name:"urlKeyword",result:{count:0}};return"undefined"!=typeof this.config.url&&(a.result.count=yst_stringHelper.countMatches(this.config.url,this.keywordRegex)),a},StringHelper=function(){},StringHelper.prototype.replaceString=function(a,b,c){return"undefined"==typeof c&&(c=" "),a=a.replace(this.stringToRegex(b),c),this.stripSpaces(a)},StringHelper.prototype.matchString=function(a,b){return a.match(this.stringToRegex(b))},StringHelper.prototype.countMatches=function(a,b){var c=0,d=a.match(b);return null!==d&&(c=d.length),c},StringHelper.prototype.stringToRegex=function(a,b){var c="",d="\\b";b&&(d="");for(var e=0;e<a.length;e++)c.length>0&&(c+="|"),c+=a[e]+d;return new RegExp(c,"g")},StringHelper.prototype.stripSpaces=function(a){return a=a.replace(/ {2,}/g," "),a=a.replace(/^\s+|\s+$/g,"")},PreProcessor=function(a){this.__store={},this.__store.originalText=a,"object"!=typeof yst_stringHelper&&(yst_stringHelper=new StringHelper),this.init()},PreProcessor.prototype.init=function(){this.textFormat(),this.wordcount()},PreProcessor.prototype.textFormat=function(){this.__store.cleanText=this.cleanText(this.__store.originalText),this.__store.cleanTextSomeTags=this.stripSomeTags(this.__store.cleanText),this.__store.cleanTextNoTags=this.stripAllTags(this.__store.cleanTextSomeTags)},PreProcessor.prototype.wordcount=function(){this.__store.wordcount=this.__store.cleanText.split(" ").length,this.__store.wordcountNoTags=this.__store.cleanTextNoTags.split(" ").length,this.__store.sentencecount=this.__store.cleanText.split(".").length,this.__store.sentencecountNoTags=this.__store.cleanTextNoTags.split(".").length,this.__store.syllablecount=this.syllableCount(this.__store.cleanTextNoTags)},PreProcessor.prototype.syllableCount=function(a){this.syllableCount=0,a=a.replace(/[.]/g," "),a=this.removeWords(a);for(var b=a.split(" "),c=yst_stringHelper.stringToRegex(preprocessorConfig.syllables.subtractSyllables,!0),d=yst_stringHelper.stringToRegex(preprocessorConfig.syllables.addSyllables,!0),e=0;e<b.length;e++)this.basicSyllableCount(b[e].split(/[^aeiouy]/g)),this.advancedSyllableCount(b[e],c,"subtract"),this.advancedSyllableCount(b[e],d,"add");return this.syllableCount},PreProcessor.prototype.basicSyllableCount=function(a){for(var b=0;b<a.length;b++)a[b].length>0&&this.syllableCount++},PreProcessor.prototype.advancedSyllableCount=function(a,b,c){var d=a.match(b);null!==d&&("subtract"===c?this.syllableCount-=d.length:"add"===c&&(this.syllableCount+=d.length))},PreProcessor.prototype.removeWords=function(a){for(var b=0;b<preprocessorConfig.syllables.exclusionWords.length;b++){var c=new RegExp(preprocessorConfig.syllables.exclusionWords[b].word,"g"),d=a.match(c);null!==d&&(this.syllableCount+=preprocessorConfig.syllables.exclusionWords[b].syllables,a=a.replace(c,""))}return a},PreProcessor.prototype.cleanText=function(a){return a=a.toLocaleLowerCase(),a=a.replace(/[-;:,()"'|“”]/g," "),a=a.replace(/[’]/g,""),a=a.replace(/[.?!]/g,"."),a+=".",a=a.replace(/[ ]*(\n|\r\n|\r)[ ]*/g," "),a=a.replace(/([\.])[\. ]+/g,"$1"),a=a.replace(/[ ]*([\.])+/g,"$1 "),a=a.replace(/[0-9]+[ ]/g,""),yst_stringHelper.stripSpaces(a)},PreProcessor.prototype.stripSomeTags=function(a){return a=a.replace(/<(?!li|\/li|p|\/p|h1|\/h1|h2|\/h2|h3|\/h3|h4|\/h4|h5|\/h5|h6|\/h6|dd).*?\>/g," "),a=yst_stringHelper.stripSpaces(a)},PreProcessor.prototype.stripAllTags=function(a){return a=a.replace(/(<([^>]+)>)/gi," "),a=yst_stringHelper.stripSpaces(a)};